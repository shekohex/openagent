{
  "id": "task-7",
  "title": "Crypto utils: AES-256-GCM + master key",
  "description": "Implement AES-256-GCM utilities and master key loader (OPENAGENT_MASTER_KEY or KMS stub) with zeroization.",
  "requirements": [
    "Key: 32 bytes; Nonce: 12 bytes; Tag: 16 bytes",
    "Return { ciphertext, nonce, tag } as Uint8Array",
    "Additional authenticated data (AAD) support: provider identifier",
    "Zeroize key material after use"
  ],
  "plan": [
    "Implement random key/nonce generation",
    "Implement encrypt/decrypt with AAD support",
    "Load master key from env or stub KMS interface",
    "Unit tests: roundtrip, wrong key/nonce/tag, AAD mismatch"
  ],
  "expected_outcome": "Reliable AES-GCM utilities and master key loader with tests.",
  "acceptance_criteria": [
    "All tests pass for success and failure cases",
    "TypeScript types precise and used by envelope service"
  ],
  "deliverables": [
    "packages/shared/crypto/aesgcm.ts",
    "packages/shared/crypto/masterKey.ts",
    "tests/crypto/*.test.ts"
  ],
  "test_plan": [
    "bun test crypto suite",
    "Fuzz test random plaintext sizes"
  ],
  "references": ["PLAN.md section 10"],
  "dependencies": ["task-0"],
  "status": "pending"
}